# vulnerability_map.py

VULNERABILITY_MAP = {

    # ======================
    # RESOURCE / AVAILABILITY
    # ======================

    "CPU Spike": {
        "cwe": "CWE-400",
        "title": "Uncontrolled Resource Consumption",
        "description": (
            "Excessive CPU usage without proper limits can degrade "
            "system performance and lead to denial of service."
        ),
        "example_cves": ["CVE-2022-29172", "CVE-2021-3156"]
    },

    "Disk Usage High": {
        "cwe": "CWE-770",
        "title": "Allocation of Resources Without Limits",
        "description": (
            "Unbounded disk usage due to missing cleanup or quotas "
            "can cause service outages."
        ),
        "example_cves": ["CVE-2021-44228"]
    },

    "Memory Usage High": {
        "cwe": "CWE-401",
        "title": "Memory Leak",
        "description": (
            "Failure to release allocated memory can exhaust system "
            "resources over time."
        ),
        "example_cves": ["CVE-2020-6820"]
    },

    # ======================
    # SERVICE / ERROR HANDLING
    # ======================

    "Backend URL Unhealthy": {
        "cwe": "CWE-703",
        "title": "Improper Handling of Exceptional Conditions",
        "description": (
            "The application does not correctly handle error conditions, "
            "leading to service downtime."
        ),
        "example_cves": ["CVE-2020-0601"]
    },

    "Service Crash": {
        "cwe": "CWE-388",
        "title": "Improper Error Handling",
        "description": (
            "Unexpected application crashes due to insufficient error handling."
        ),
        "example_cves": ["CVE-2019-5736"]
    },

    # ======================
    # CONFIGURATION / POLICY
    # ======================

    "Insecure Configuration": {
        "cwe": "CWE-16",
        "title": "Configuration",
        "description": (
            "Security issues arising from insecure or incorrect configuration "
            "settings."
        ),
        "example_cves": ["CVE-2018-7600"]
    },

    "Open Network Port": {
        "cwe": "CWE-284",
        "title": "Improper Access Control",
        "description": (
            "Unrestricted network access can expose services to unauthorized users."
        ),
        "example_cves": ["CVE-2017-0144"]
    },

    # ======================
    # MAINTENANCE / PATCHING
    # ======================

    "Missing Security Updates": {
        "cwe": "CWE-1104",
        "title": "Use of Unmaintained Third Party Components",
        "description": (
            "Running outdated or unpatched software increases exposure to "
            "known vulnerabilities."
        ),
        "example_cves": ["CVE-2021-34527"]
    },

    "Outdated Dependency": {
        "cwe": "CWE-937",
        "title": "Using Components with Known Vulnerabilities",
        "description": (
            "Use of software components with publicly known vulnerabilities."
        ),
        "example_cves": ["CVE-2021-45105"]
    },

    # ======================
    # FALLBACK / GENERIC
    # ======================

    "Unknown Incident": {
        "cwe": "CWE-1059",
        "title": "Insufficient Technical Impact Assessment",
        "description": (
            "The issue could not be fully classified due to lack of information."
        ),
        "example_cves": []
    }
}
